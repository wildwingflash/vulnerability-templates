# Command injection 

[CWE-77](https://cwe.mitre.org/data/definitions/77.html)

[CVSS 3.1 Score 7.5](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H&version=3.1)

## Description

Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application. Command injection attacks are possible when an application passes unsafe user supplied data (forms, cookies, HTTP headers etc.) to a system shell. In this attack, the attacker-supplied operating system commands are usually executed with the privileges of the vulnerable application. Command injection attacks are possible largely due to insufficient input validation.

## Security Impact

The following request and response is an example of a successful attack:

```
Request http://127.0.0.1/delete.php?filename=bob.txt;id
```

Response

```bash
Please specify the name of the file to delete

uid=33(www-data) gid=33(www-data) groups=33(www-data)
```


## Affected asset


## Remediation

Ideally, a developer should use existing API for their language. For example (Java): Rather than use Runtime.exec() to issue a ‘mail’ command, use the available Java API located at javax.mail.*.

If no such available API exists, the developer should scrub all input for malicious characters. Implementing a positive security model would be most efficient. Typically, it is much easier to define the legal characters than the illegal characters.

## External References

- https://owasp.org/www-community/attacks/Command_Injection
- https://portswigger.net/web-security/os-command-injection
