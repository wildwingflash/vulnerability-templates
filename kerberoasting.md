# Kerberoasting

[CWE-522](https://cwe.mitre.org/data/definitions/522.html)

[CVSS 3.1 Score 7.5](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H&version=3.1)

## Description

Through the exploitation of how service accounts leverage Kerberos authentication with Service Principal Names (SPNs), the adversary obtains and subsequently cracks the hashed credentials of a service account target to exploit its privileges.  

## Security Impact

The Kerberos authentication protocol centers around a ticketing system which is used to request/grant access to services and to then access the requested services. As an authenticated user, the adversary may request Active Directory and obtain a service ticket with portions encrypted via RC4 with the private key of the authenticated account. By extracting the local ticket and saving it disk, the adversary can brute force the hashed value to reveal the target account credentials.

## Affected asset


## Remediation

In order to make sure that privileged accounts are not affected by the Kerberoast attack, different measures can be taken:

- remove the Service Principal Name from the user account
- if a Service Principal Name associated with a user account is required for functional reasons, use an unprivileged account instead
- increase the complexity of the password:
    - use Group Managed Service Accounts (gMSA) instead of user accounts
    - use Smart Cards for sensitive accounts


## External References

- https://attack.mitre.org/techniques/T1558/003/
- http://gost.isi.edu/publications/kerberos-neuman-tso.html
- https://adsecurity.org/?p=3466
- http://www.nessus.org/u?d5c4c81f